!function(){var t={58394:function(t,e,n){"use strict";t.exports=n.p+"8e024c944c5646993c51.css"},60947:function(t,e,n){"use strict";t.exports=n.p+"8438e63bc500c30521ad.js"}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var a=e[o]={exports:{}};return t[o](a,a.exports,n),a.exports}n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var o=e.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=o[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function n(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,n){return(e=a(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,a(o.key),o)}}function a(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var c=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentMonth=new Date,this.forms=this.loadFromStorage(),this.init()},e=[{key:"init",value:function(){var t=this;this.updateCurrentDate(),this.updateCurrentMonth(),this.renderForms(),this.updateStats(),this.setupEventListeners(),setInterval((function(){return t.updateCurrentDate()}),6e4)}},{key:"setupEventListeners",value:function(){var t=this;document.addEventListener("input",(function(e){e.target.classList.contains("form-textarea")&&t.autoSave()})),document.addEventListener("keydown",(function(e){if(e.target.classList.contains("form-textarea")&&"Enter"===e.key&&!e.shiftKey){e.preventDefault();var n=e.target,o=n.selectionStart,r=n.selectionEnd;n.value=n.value.substring(0,o)+"\n"+n.value.substring(r),n.selectionStart=n.selectionEnd=o+1,t.autoSave()}}))}},{key:"updateCurrentDate",value:function(){var t=new Date;document.getElementById("current-date").textContent=t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}},{key:"updateCurrentMonth",value:function(){var t="".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][this.currentMonth.getMonth()]," ").concat(this.currentMonth.getFullYear());document.getElementById("current-month").textContent=t,document.getElementById("nav-month").textContent=t}},{key:"formatDate",value:function(t){var e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return"".concat(e,"/").concat(n,"/").concat(o)}},{key:"formatDateTime",value:function(t){var e=this.formatDate(t),n=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return"".concat(e," ").concat(n)}},{key:"loadFromStorage",value:function(){try{var t=localStorage.getItem("payroll-forms");return t?JSON.parse(t):{}}catch(t){return console.error("Error loading from storage:",t),{}}}},{key:"saveToStorage",value:function(){try{localStorage.setItem("payroll-forms",JSON.stringify(this.forms)),this.updateLastUpdated()}catch(t){console.error("Error saving to storage:",t),this.showToast("Error saving data","error")}}},{key:"autoSave",value:function(){var t=this;clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout((function(){t.saveAllForms()}),1e3)}},{key:"saveAllForms",value:function(){var t=this;document.querySelectorAll(".form-textarea").forEach((function(e){var n=e.dataset.formId;n&&t.forms[n]&&(t.forms[n].content=e.value,t.forms[n].lastModified=(new Date).toISOString())})),this.saveToStorage()}},{key:"updateLastUpdated",value:function(){var t=(new Date).toLocaleString();document.getElementById("last-updated").textContent=t}},{key:"getMonthKey",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentMonth;return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"))}},{key:"getCurrentMonthForms",value:function(){var t=this.getMonthKey();return Object.values(this.forms).filter((function(e){return e.monthKey===t})).sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)}))}},{key:"addNewForm",value:function(){var t=new Date,e="form_".concat(t.getTime()),n=this.getMonthKey(),o={id:e,createdAt:t.toISOString(),lastModified:t.toISOString(),monthKey:n,content:"",date:this.formatDate(t)};this.forms[e]=o,this.saveToStorage(),this.renderForms(),this.updateStats(),setTimeout((function(){var t=document.querySelector('[data-form-id="'.concat(e,'"]'));t&&t.focus()}),100),this.showToast("New form added successfully!")}},{key:"deleteForm",value:function(t){this.forms[t]&&(delete this.forms[t],this.saveToStorage(),this.renderForms(),this.updateStats(),this.showToast("Form deleted successfully!"))}},{key:"duplicateForm",value:function(t){if(this.forms[t]){var e=this.forms[t],o=new Date,r="form_".concat(o.getTime()),a=n(n({},e),{},{id:r,createdAt:o.toISOString(),lastModified:o.toISOString(),date:this.formatDate(o)});this.forms[r]=a,this.saveToStorage(),this.renderForms(),this.updateStats(),this.showToast("Form duplicated successfully!")}}},{key:"changeMonth",value:function(t){this.currentMonth.setMonth(this.currentMonth.getMonth()+t),this.updateCurrentMonth(),this.renderForms()}},{key:"goToToday",value:function(){this.currentMonth=new Date,this.updateCurrentMonth(),this.renderForms()}},{key:"renderForms",value:function(){var t=document.getElementById("forms-container"),e=document.getElementById("empty-state"),n=this.getCurrentMonthForms();t.innerHTML="",0===n.length?e.classList.remove("hidden"):(e.classList.add("hidden"),n.forEach((function(e){var n=document.createElement("div");n.className="form-entry",n.innerHTML='\n                    <div class="form-header">\n                        <div class="form-date">Added on: '.concat(e.date,'</div>\n                        <div class="form-actions">\n                            <button onclick="formSystem.duplicateForm(\'').concat(e.id,"')\">Duplicate</button>\n                            <button onclick=\"formSystem.deleteForm('").concat(e.id,'\')">Delete</button>\n                        </div>\n                    </div>\n                    <div class="form-content">\n                        <textarea class="form-textarea" data-form-id="').concat(e.id,'" placeholder="Enter your comment here...">').concat(e.content,"</textarea>\n                    </div>\n                "),t.appendChild(n)})))}},{key:"updateStats",value:function(){var t=Object.keys(this.forms).length,e=this.getCurrentMonthForms().length;document.getElementById("total-forms").textContent=t,document.getElementById("month-forms").textContent=e}},{key:"showToast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=document.getElementById("toast");document.getElementById("toast-message").textContent=t,n.className="toast ".concat(e),n.classList.add("show"),setTimeout((function(){n.classList.remove("show")}),3e3)}},{key:"exportData",value:function(){document.getElementById("export-modal").classList.add("show")}},{key:"closeExportModal",value:function(){document.getElementById("export-modal").classList.remove("show")}},{key:"exportToJSON",value:function(){var t=JSON.stringify(this.forms,null,2),e="data:application/json;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","payroll-forms.json"),n.click(),this.closeExportModal()}},{key:"exportToCSV",value:function(){var t="id,createdAt,lastModified,monthKey,content,date\n";Object.values(this.forms).forEach((function(e){t+='"'.concat(e.id,'","').concat(e.createdAt,'","').concat(e.lastModified,'","').concat(e.monthKey,'","').concat(e.content.replace(/"/g,'""'),'","').concat(e.date,'"\n')}));var e="data:text/csv;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","payroll-forms.csv"),n.click(),this.closeExportModal()}},{key:"exportToText",value:function(){var t="";Object.values(this.forms).forEach((function(e){t+="ID: ".concat(e.id,"\nCreated At: ").concat(e.createdAt,"\nLast Modified: ").concat(e.lastModified,"\nMonth: ").concat(e.monthKey,"\nDate: ").concat(e.date,"\nContent: ").concat(e.content,"\n\n")}));var e="data:text/plain;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","payroll-forms.txt"),n.click(),this.closeExportModal()}},{key:"clearAllData",value:function(){confirm("Are you sure you want to clear all data?")&&(this.forms={},this.saveToStorage(),this.renderForms(),this.updateStats(),this.showToast("All data cleared successfully!"))}}],e&&r(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();new c}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map