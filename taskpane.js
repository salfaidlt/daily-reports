/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var t={58394:function(t,e,n){"use strict";t.exports=n.p+"92db6e7b1436651d3b84.css"},60947:function(t,e,n){"use strict";t.exports=n.p+"e469258218b8f70a79a3.js"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function n(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function r(t,e,n){return(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function c(n,r,o,i){var c=r&&r.prototype instanceof u?r:u,l=Object.create(c.prototype);return a(l,"_invoke",function(n,r,o){var a,i,c,u=0,l=o||[],f=!1,h={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return a=e,i=0,c=t,h.n=n,s}};function d(n,r){for(i=n,c=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],d=h.p,m=a[2];n>3?(o=m===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=d&&((o=n<2&&d<a[1])?(i=0,h.v=r,h.n=a[1]):d<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,h.n=m,i=0))}if(o||n>1)return s;throw f=!0,r}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),i=l,c=m;(e=i<2?t:c)||!f;){a||(i?i<3?(i>1&&(h.n=-1),d(i,c)):h.n=c:h.v=c);try{if(u=2,a){if(i||(o="next"),e=a[o]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((e=(f=h.n<0)?c:n.call(r,h))!==s)break}catch(e){a=t,i=1,c=e}finally{u=1}}return{value:e,done:f}}}(n,o,i),!0),l}var s={};function u(){}function l(){}function f(){}e=Object.getPrototypeOf;var h=[][r]?e(e([][r]())):(a(e={},r,(function(){return this})),e),d=f.prototype=u.prototype=Object.create(h);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,a(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=f,a(d,"constructor",f),a(f,"constructor",l),l.displayName="GeneratorFunction",a(f,i,"GeneratorFunction"),a(d),a(d,i,"Generator"),a(d,r,(function(){return this})),a(d,"toString",(function(){return"[object Generator]"})),(o=function(){return{w:c,m:m}})()}function a(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){a(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},a(t,e,n,r)}function i(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function c(t){i(a,r,o,c,s,"next",t)}function s(t){i(a,r,o,c,s,"throw",t)}c(void 0)}))}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var l=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetWorkbookName="test.xlsx",this.targetSheetName="Sheet1",this.isAddInConfigured=!0,this.initializeExcelEvents(),this.currentMonth=new Date,this.forms=this.loadFromStorage(),this.init()},e=[{key:"init",value:function(){var t=this;this.updateCurrentDate(),this.updateCurrentMonth(),this.renderForms(),this.updateStats(),this.setupEventListeners(),setInterval((function(){return t.updateCurrentDate()}),6e4)}},{key:"initializeExcelEvents",value:(g=c(o().m((function t(){var e,n=this;return o().w((function(t){for(;;)switch(t.n){case 0:if(t.p=0,Office.context.host!==Office.HostType.Excel){t.n=2;break}return t.n=1,this.getSetting("test");case 1:return t.v&&(this.isAddInConfigured=!0,this.monitorSheetActivation()),t.n=2,Excel.run(function(){var t=c(o().m((function t(e){return o().w((function(t){for(;;)switch(t.n){case 0:return e.workbook.worksheets.onActivated.add(n.handleSheetActivation.bind(n)),t.n=1,e.sync();case 1:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:t.n=4;break;case 3:t.p=3,e=t.v,console.error("Error initializing Excel events:",e);case 4:return t.a(2)}}),t,this,[[0,3]])}))),function(){return g.apply(this,arguments)})},{key:"monitorSheetActivation",value:(y=c(o().m((function t(){var e,n=this;return o().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=c(o().m((function t(e){var r;return o().w((function(t){for(;;)switch(t.n){case 0:return(r=e.workbook.worksheets.getActiveWorksheet()).load("test"),t.n=1,e.sync();case 1:r.name===n.targetSheetName&&Office.addin.showAsTaskpane();case 2:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,e=t.v,console.error("Error monitoring sheet activation:",e);case 3:return t.a(2)}}),t,null,[[0,2]])}))),function(){return y.apply(this,arguments)})},{key:"handleSheetActivation",value:(v=c(o().m((function t(e){var n,r;return o().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,(n=e.worksheet).load("name"),t.n=1,e.context.sync();case 1:n.name===this.targetSheetName&&this.isAddInConfigured&&Office.addin.showAsTaskpane(),t.n=3;break;case 2:t.p=2,r=t.v,console.error("Error handling sheet activation:",r);case 3:return t.a(2)}}),t,this,[[0,2]])}))),function(t){return v.apply(this,arguments)})},{key:"configureForTargetSheet",value:(p=c(o().m((function t(){var e;return o().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,this.setSetting("targetSheetConfigured",!0);case 1:this.isAddInConfigured=!0,this.monitorSheetActivation(),this.showToast("Add-in will now open automatically for this sheet"),t.n=3;break;case 2:t.p=2,e=t.v,console.error("Error configuring for target sheet:",e),this.showToast("Error configuring automatic opening","error");case 3:return t.a(2)}}),t,this,[[0,2]])}))),function(){return p.apply(this,arguments)})},{key:"getSetting",value:(m=c(o().m((function t(e){return o().w((function(t){for(;;)if(0===t.n)return t.a(2,new Promise((function(t){Office.context.document.settings.get(e,(function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):t(null)}))})))}),t)}))),function(t){return m.apply(this,arguments)})},{key:"setSetting",value:(h=c(o().m((function t(e,n){return o().w((function(t){for(;;)if(0===t.n)return t.a(2,new Promise((function(t){Office.context.document.settings.set(e,n),Office.context.document.settings.saveAsync((function(e){t(e.status===Office.AsyncResultStatus.Succeeded)}))})))}),t)}))),function(t,e){return h.apply(this,arguments)})},{key:"loadFromExcel",value:(l=c(o().m((function t(){return o().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,f();case 1:this.forms=t.v;case 2:return t.a(2)}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"saveToExcel",value:(u=c(o().m((function t(){return o().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,d(this.forms);case 1:return t.a(2)}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var t=this;document.addEventListener("input",(function(e){e.target.classList.contains("form-textarea")&&t.isCurrentMonth()&&t.autoSave()})),document.addEventListener("keydown",(function(e){if(e.target.classList.contains("form-textarea")&&"Enter"===e.key&&!e.shiftKey&&t.isCurrentMonth()){e.preventDefault();var n=e.target,r=n.selectionStart,o=n.selectionEnd;n.value=n.value.substring(0,r)+"\n"+n.value.substring(o),n.selectionStart=n.selectionEnd=r+1,t.autoSave()}}))}},{key:"updateCurrentDate",value:function(){var t=new Date;document.getElementById("current-date").textContent=t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}},{key:"isCurrentMonth",value:function(){var t=new Date;return this.currentMonth.getMonth()===t.getMonth()&&this.currentMonth.getFullYear()===t.getFullYear()}},{key:"updateCurrentMonth",value:function(){var t="".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][this.currentMonth.getMonth()]," ").concat(this.currentMonth.getFullYear());document.getElementById("current-month").textContent=t,document.getElementById("nav-month").textContent=t}},{key:"formatDate",value:function(t){var e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),r=t.getFullYear();return"".concat(e,"/").concat(n,"/").concat(r)}},{key:"formatDateTime",value:function(t){var e=this.formatDate(t),n=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return"".concat(e," ").concat(n)}},{key:"loadFromStorage",value:function(){try{var t=localStorage.getItem("payroll-forms");return t?JSON.parse(t):{}}catch(t){return console.error("Error loading from storage:",t),{}}}},{key:"saveToStorage",value:function(){try{localStorage.setItem("payroll-forms",JSON.stringify(this.forms)),this.updateLastUpdated()}catch(t){console.error("Error saving to storage:",t),this.showToast("Error saving data","error")}}},{key:"autoSave",value:function(){var t=this;clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout((function(){t.saveAllForms()}),1e3)}},{key:"saveAllForms",value:function(){var t=this;document.querySelectorAll(".form-textarea").forEach((function(e){var n=e.dataset.formId;n&&t.forms[n]&&(t.forms[n].content=e.value,t.forms[n].lastModified=(new Date).toISOString())})),this.saveToStorage()}},{key:"updateLastUpdated",value:function(){var t=(new Date).toLocaleString();document.getElementById("last-updated").textContent=t}},{key:"getMonthKey",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentMonth;return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"))}},{key:"getCurrentMonthForms",value:function(){var t=this.getMonthKey();return Object.values(this.forms).filter((function(e){return e.monthKey===t})).sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)}))}},{key:"addNewForm",value:(i=c(o().m((function t(){var e,n,r,a;return o().w((function(t){for(;;)switch(t.n){case 0:e=new Date,n="form_".concat(e.getTime()),r=this.getMonthKey(),a={id:n,createdAt:e.toISOString(),lastModified:e.toISOString(),monthKey:r,content:"",date:this.formatDate(e)},this.forms[n]=a,this.renderForms(),this.updateStats(),setTimeout((function(){var t=document.querySelector('[data-form-id="'.concat(n,'"]'));t&&t.focus()}),100),this.showToast("New form added successfully!");case 1:return t.a(2)}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"deleteForm",value:(a=c(o().m((function t(e){return o().w((function(t){for(;;)switch(t.n){case 0:if(!this.forms[e]){t.n=2;break}return delete this.forms[e],t.n=1,this.saveToExcel();case 1:this.renderForms(),this.updateStats(),this.showToast("Form deleted successfully!");case 2:return t.a(2)}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"duplicateForm",value:(r=c(o().m((function t(e){var r,a,i,c;return o().w((function(t){for(;;)switch(t.n){case 0:if(!this.forms[e]){t.n=2;break}return r=this.forms[e],a=new Date,i="form_".concat(a.getTime()),c=n(n({},r),{},{id:i,createdAt:a.toISOString(),lastModified:a.toISOString(),date:this.formatDate(a)}),this.forms[i]=c,t.n=1,this.saveToExcel();case 1:this.renderForms(),this.updateStats(),this.showToast("Form duplicated successfully!");case 2:return t.a(2)}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"changeMonth",value:function(t){this.currentMonth.setMonth(this.currentMonth.getMonth()+t),this.updateCurrentMonth(),this.renderForms()}},{key:"goToToday",value:function(){this.currentMonth=new Date,this.updateCurrentMonth(),this.renderForms()}},{key:"renderForms",value:function(){var t=document.getElementById("forms-container"),e=document.getElementById("empty-state"),n=this.getCurrentMonthForms(),r=this.isCurrentMonth();t.innerHTML="",0===n.length?e.classList.remove("hidden"):(e.classList.add("hidden"),n.forEach((function(e){var n=document.createElement("div");n.className="form-entry",n.innerHTML='\n                    <div class="form-header">\n                        <div class="form-date">Added on: '.concat(e.date,'</div>\n                        <div class="form-actions">\n                            <button ').concat(r?"onclick=\"formSystem.duplicateForm('".concat(e.id,"')\""):"disabled",">Duplicate</button>\n                            <button ").concat(r?"onclick=\"formSystem.deleteForm('".concat(e.id,"')\""):"disabled",'>Delete</button>\n                        </div>\n                    </div>\n                    <div class="form-content">\n                        <textarea class="form-textarea" data-form-id="').concat(e.id,'" ').concat(r?"":"readonly",' placeholder="Enter your comment here...">').concat(e.content,"</textarea>\n                    </div>\n                "),t.appendChild(n)}))),document.querySelector(".btn-primary").disabled=!r}},{key:"updateStats",value:function(){var t=Object.keys(this.forms).length,e=this.getCurrentMonthForms().length;document.getElementById("total-forms").textContent=t,document.getElementById("month-forms").textContent=e}},{key:"showToast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=document.getElementById("toast");document.getElementById("toast-message").textContent=t,n.className="toast ".concat(e),n.classList.add("show"),setTimeout((function(){n.classList.remove("show")}),3e3)}},{key:"exportData",value:function(){document.getElementById("export-modal").classList.add("show")}},{key:"closeExportModal",value:function(){document.getElementById("export-modal").classList.remove("show")}},{key:"exportToJSON",value:function(){var t=JSON.stringify(this.forms,null,2),e="data:application/json;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","payroll-forms.json"),n.click(),this.closeExportModal()}},{key:"exportToCSV",value:function(){var t=this.getCurrentMonthForms(),e="id,createdAt,lastModified,monthKey,content,date\n";t.forEach((function(t){e+='"'.concat(t.id,'","').concat(t.createdAt,'","').concat(t.lastModified,'","').concat(t.monthKey,'","').concat(t.content.replace(/"/g,'""'),'","').concat(t.date,'"\n')}));var n="data:text/csv;charset=utf-8,"+encodeURIComponent(e),r=this.getMonthKey(this.currentMonth),o="payroll-forms-".concat(r,".csv"),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",o),a.click(),this.closeExportModal()}},{key:"exportToText",value:function(){var t="";Object.values(this.forms).forEach((function(e){t+="ID: ".concat(e.id,"\nCreated At: ").concat(e.createdAt,"\nLast Modified: ").concat(e.lastModified,"\nMonth: ").concat(e.monthKey,"\nDate: ").concat(e.date,"\nContent: ").concat(e.content,"\n\n")}));var e="data:text/plain;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","payroll-forms.txt"),n.click(),this.closeExportModal()}},{key:"clearAllData",value:function(){confirm("Are you sure you want to clear all data?")&&(this.forms={},this.saveToStorage(),this.renderForms(),this.updateStats(),this.showToast("All data cleared successfully!"))}}],e&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,a,i,u,l,h,m,p,v,y,g}();function f(){return h.apply(this,arguments)}function h(){return h=c(o().m((function t(){var e;return o().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=c(o().m((function t(e){var n,r,a,i,c,s,u,l,f;return o().w((function(t){for(;;)switch(t.n){case 0:return n=e.workbook.worksheets.getActiveWorksheet(),(r=n.getUsedRange()).load("values"),t.n=1,e.sync();case 1:for(a=r.values,i=a[0],c={},s=1;s<a.length;s++){for(u=a[s],l={},f=0;f<i.length;f++)l[i[f]]=u[f];c[l.id]=l}return t.a(2,c)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,e=t.v,console.error("Error loading data from Excel:",e),OfficeHelpers.Utilities.log(e);case 3:return t.a(2)}}),t,null,[[0,2]])}))),h.apply(this,arguments)}function d(t){return m.apply(this,arguments)}function m(){return m=c(o().m((function t(e){var n;return o().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=c(o().m((function t(n){var r,a;return o().w((function(t){for(;;)switch(t.n){case 0:return(r=n.workbook.worksheets.getActiveWorksheet()).getUsedRange().clear(),a=[["id","content","date"]],Object.values(e).forEach((function(t){a.push([t.id,t.content,t.date])})),r.getRangeByIndexes(0,0,a.length,a[0].length).values=a,t.n=1,n.sync();case 1:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("Error saving data to Excel:",n),OfficeHelpers.Utilities.log(n);case 3:return t.a(2)}}),t,null,[[0,2]])}))),m.apply(this,arguments)}new l}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map