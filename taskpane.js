/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var t={58394:function(t,e,n){"use strict";t.exports=n.p+"bfc869af5bf183b3158b.css"},60947:function(t,e,n){"use strict";t.exports=n.p+"27f96815b2eb856aa5c1.js"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function n(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function r(t,e,n){return(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",c=n.toStringTag||"@@toStringTag";function i(n,r,o,c){var i=r&&r.prototype instanceof u?r:u,l=Object.create(i.prototype);return a(l,"_invoke",function(n,r,o){var a,c,i,u=0,l=o||[],f=!1,d={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return a=e,c=0,i=t,d.n=n,s}};function h(n,r){for(c=n,i=r,e=0;!f&&u&&!o&&e<l.length;e++){var o,a=l[e],h=d.p,m=a[2];n>3?(o=m===r)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=h&&((o=n<2&&h<a[1])?(c=0,d.v=r,d.n=a[1]):h<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,d.n=m,c=0))}if(o||n>1)return s;throw f=!0,r}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&h(l,m),c=l,i=m;(e=c<2?t:i)||!f;){a||(c?c<3?(c>1&&(d.n=-1),h(c,i)):d.n=i:d.v=i);try{if(u=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?i:n.call(r,d))!==s)break}catch(e){a=t,c=1,i=e}finally{u=1}}return{value:e,done:f}}}(n,o,c),!0),l}var s={};function u(){}function l(){}function f(){}e=Object.getPrototypeOf;var d=[][r]?e(e([][r]())):(a(e={},r,(function(){return this})),e),h=f.prototype=u.prototype=Object.create(d);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,a(t,c,"GeneratorFunction")),t.prototype=Object.create(h),t}return l.prototype=f,a(h,"constructor",f),a(f,"constructor",l),l.displayName="GeneratorFunction",a(f,c,"GeneratorFunction"),a(h),a(h,c,"Generator"),a(h,r,(function(){return this})),a(h,"toString",(function(){return"[object Generator]"})),(o=function(){return{w:i,m:m}})()}function a(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var c=function(e,n){a(t,e,(function(t){return this._invoke(e,n,t)}))};c("next",0),c("throw",1),c("return",2)}},a(t,e,n,r)}function c(t,e,n,r,o,a,c){try{var i=t[a](c),s=i.value}catch(t){return void n(t)}i.done?e(s):Promise.resolve(s).then(r,o)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){c(a,r,o,i,s,"next",t)}function s(t){c(a,r,o,i,s,"throw",t)}i(void 0)}))}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var l=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentMonth=new Date,this.forms=this.loadFromStorage(),this.init()},e=[{key:"init",value:(d=i(o().m((function t(){var e=this;return o().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,this.loadFromExcel();case 1:this.updateCurrentDate(),this.updateCurrentMonth(),this.renderForms(),this.updateStats(),this.setupEventListeners(),setInterval((function(){return e.updateCurrentDate()}),6e4);case 2:return t.a(2)}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"loadFromExcel",value:(l=i(o().m((function t(){return o().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,f();case 1:this.forms=t.v;case 2:return t.a(2)}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"saveToExcel",value:(u=i(o().m((function t(){return o().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,h(this.forms);case 1:return t.a(2)}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var t=this;document.addEventListener("input",(function(e){e.target.classList.contains("form-textarea")&&t.isCurrentMonth()&&t.autoSave()})),document.addEventListener("keydown",(function(e){if(e.target.classList.contains("form-textarea")&&"Enter"===e.key&&!e.shiftKey&&t.isCurrentMonth()){e.preventDefault();var n=e.target,r=n.selectionStart,o=n.selectionEnd;n.value=n.value.substring(0,r)+"\n"+n.value.substring(o),n.selectionStart=n.selectionEnd=r+1,t.autoSave()}}))}},{key:"updateCurrentDate",value:function(){var t=new Date;document.getElementById("current-date").textContent=t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}},{key:"isCurrentMonth",value:function(){var t=new Date;return this.currentMonth.getMonth()===t.getMonth()&&this.currentMonth.getFullYear()===t.getFullYear()}},{key:"updateCurrentMonth",value:function(){var t="".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][this.currentMonth.getMonth()]," ").concat(this.currentMonth.getFullYear());document.getElementById("current-month").textContent=t,document.getElementById("nav-month").textContent=t}},{key:"formatDate",value:function(t){var e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),r=t.getFullYear();return"".concat(e,"/").concat(n,"/").concat(r)}},{key:"formatDateTime",value:function(t){var e=this.formatDate(t),n=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return"".concat(e," ").concat(n)}},{key:"loadFromStorage",value:function(){try{var t=localStorage.getItem("payroll-forms");return t?JSON.parse(t):{}}catch(t){return console.error("Error loading from storage:",t),{}}}},{key:"saveToStorage",value:function(){try{localStorage.setItem("payroll-forms",JSON.stringify(this.forms)),this.updateLastUpdated()}catch(t){console.error("Error saving to storage:",t),this.showToast("Error saving data","error")}}},{key:"autoSave",value:function(){var t=this;clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout((function(){t.saveAllForms()}),1e3)}},{key:"saveAllForms",value:function(){var t=this;document.querySelectorAll(".form-textarea").forEach((function(e){var n=e.dataset.formId;n&&t.forms[n]&&(t.forms[n].content=e.value,t.forms[n].lastModified=(new Date).toISOString())})),this.saveToStorage()}},{key:"updateLastUpdated",value:function(){var t=(new Date).toLocaleString();document.getElementById("last-updated").textContent=t}},{key:"getMonthKey",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentMonth;return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"))}},{key:"getCurrentMonthForms",value:function(){var t=this.getMonthKey();return Object.values(this.forms).filter((function(e){return e.monthKey===t})).sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)}))}},{key:"addNewForm",value:(c=i(o().m((function t(){var e,n,r,a;return o().w((function(t){for(;;)switch(t.n){case 0:return e=new Date,n="form_".concat(e.getTime()),r=this.getMonthKey(),a={id:n,createdAt:e.toISOString(),lastModified:e.toISOString(),monthKey:r,content:"",date:this.formatDate(e)},this.forms[n]=a,t.n=1,this.saveToExcel();case 1:this.renderForms(),this.updateStats(),setTimeout((function(){var t=document.querySelector('[data-form-id="'.concat(n,'"]'));t&&t.focus()}),100),this.showToast("New form added successfully!");case 2:return t.a(2)}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"deleteForm",value:(a=i(o().m((function t(e){return o().w((function(t){for(;;)switch(t.n){case 0:if(!this.forms[e]){t.n=2;break}return delete this.forms[e],t.n=1,this.saveToExcel();case 1:this.renderForms(),this.updateStats(),this.showToast("Form deleted successfully!");case 2:return t.a(2)}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"duplicateForm",value:(r=i(o().m((function t(e){var r,a,c,i;return o().w((function(t){for(;;)switch(t.n){case 0:if(!this.forms[e]){t.n=2;break}return r=this.forms[e],a=new Date,c="form_".concat(a.getTime()),i=n(n({},r),{},{id:c,createdAt:a.toISOString(),lastModified:a.toISOString(),date:this.formatDate(a)}),this.forms[c]=i,t.n=1,this.saveToExcel();case 1:this.renderForms(),this.updateStats(),this.showToast("Form duplicated successfully!");case 2:return t.a(2)}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"changeMonth",value:function(t){this.currentMonth.setMonth(this.currentMonth.getMonth()+t),this.updateCurrentMonth(),this.renderForms()}},{key:"goToToday",value:function(){this.currentMonth=new Date,this.updateCurrentMonth(),this.renderForms()}},{key:"renderForms",value:function(){var t=document.getElementById("forms-container"),e=document.getElementById("empty-state"),n=this.getCurrentMonthForms(),r=this.isCurrentMonth();t.innerHTML="",0===n.length?e.classList.remove("hidden"):(e.classList.add("hidden"),n.forEach((function(e){var n=document.createElement("div");n.className="form-entry",n.innerHTML='\n                    <div class="form-header">\n                        <div class="form-date">Added on: '.concat(e.date,'</div>\n                        <div class="form-actions">\n                            <button ').concat(r?"onclick=\"formSystem.duplicateForm('".concat(e.id,"')\""):"disabled",">Duplicate</button>\n                            <button ").concat(r?"onclick=\"formSystem.deleteForm('".concat(e.id,"')\""):"disabled",'>Delete</button>\n                        </div>\n                    </div>\n                    <div class="form-content">\n                        <textarea class="form-textarea" data-form-id="').concat(e.id,'" ').concat(r?"":"readonly",' placeholder="Enter your comment here...">').concat(e.content,"</textarea>\n                    </div>\n                "),t.appendChild(n)}))),document.querySelector(".btn-primary").disabled=!r}},{key:"updateStats",value:function(){var t=Object.keys(this.forms).length,e=this.getCurrentMonthForms().length;document.getElementById("total-forms").textContent=t,document.getElementById("month-forms").textContent=e}},{key:"showToast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=document.getElementById("toast");document.getElementById("toast-message").textContent=t,n.className="toast ".concat(e),n.classList.add("show"),setTimeout((function(){n.classList.remove("show")}),3e3)}},{key:"exportData",value:function(){document.getElementById("export-modal").classList.add("show")}},{key:"closeExportModal",value:function(){document.getElementById("export-modal").classList.remove("show")}},{key:"exportToJSON",value:function(){var t=JSON.stringify(this.forms,null,2),e="data:application/json;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","payroll-forms.json"),n.click(),this.closeExportModal()}},{key:"exportToCSV",value:function(){var t="id,createdAt,lastModified,monthKey,content,date\n";Object.values(this.forms).forEach((function(e){t+='"'.concat(e.id,'","').concat(e.createdAt,'","').concat(e.lastModified,'","').concat(e.monthKey,'","').concat(e.content.replace(/"/g,'""'),'","').concat(e.date,'"\n')}));var e="data:text/csv;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","payroll-forms.csv"),n.click(),this.closeExportModal()}},{key:"exportToText",value:function(){var t="";Object.values(this.forms).forEach((function(e){t+="ID: ".concat(e.id,"\nCreated At: ").concat(e.createdAt,"\nLast Modified: ").concat(e.lastModified,"\nMonth: ").concat(e.monthKey,"\nDate: ").concat(e.date,"\nContent: ").concat(e.content,"\n\n")}));var e="data:text/plain;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","payroll-forms.txt"),n.click(),this.closeExportModal()}},{key:"clearAllData",value:function(){confirm("Are you sure you want to clear all data?")&&(this.forms={},this.saveToStorage(),this.renderForms(),this.updateStats(),this.showToast("All data cleared successfully!"))}}],e&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,a,c,u,l,d}();function f(){return d.apply(this,arguments)}function d(){return d=i(o().m((function t(){var e;return o().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=i(o().m((function t(e){var n,r,a,c,i,s,u,l,f;return o().w((function(t){for(;;)switch(t.n){case 0:return n=e.workbook.worksheets.getActiveWorksheet(),(r=n.getUsedRange()).load("values"),t.n=1,e.sync();case 1:for(a=r.values,c=a[0],i={},s=1;s<a.length;s++){for(u=a[s],l={},f=0;f<c.length;f++)l[c[f]]=u[f];i[l.id]=l}return t.a(2,i)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,e=t.v,console.error("Error loading data from Excel:",e),OfficeHelpers.Utilities.log(e);case 3:return t.a(2)}}),t,null,[[0,2]])}))),d.apply(this,arguments)}function h(t){return m.apply(this,arguments)}function m(){return m=i(o().m((function t(e){var n;return o().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Excel.run(function(){var t=i(o().m((function t(n){var r,a;return o().w((function(t){for(;;)switch(t.n){case 0:return(r=n.workbook.worksheets.getActiveWorksheet()).getUsedRange().clear(),a=[["id","content","date"]],Object.values(e).forEach((function(t){a.push([t.id,t.content,t.date])})),r.getRangeByIndexes(0,0,a.length,a[0].length).values=a,t.n=1,n.sync();case 1:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("Error saving data to Excel:",n),OfficeHelpers.Utilities.log(n);case 3:return t.a(2)}}),t,null,[[0,2]])}))),m.apply(this,arguments)}new l}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map