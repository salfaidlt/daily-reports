/*! For license information please see e2bbce044142dcade0ba.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var s=n&&n.prototype instanceof i?n:i,u=Object.create(s.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var a,i,s,u=0,l=o||[],f=!1,h={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,r){return a=t,i=0,s=e,h.n=r,c}};function d(r,n){for(i=r,s=n,t=0;!f&&u&&!o&&t<l.length;t++){var o,a=l[t],d=h.p,m=a[2];r>3?(o=m===n)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=r<2&&d<a[1])?(i=0,h.v=n,h.n=a[1]):d<m&&(o=r<3||a[0]>n||n>m)&&(a[4]=r,a[5]=n,h.n=m,i=0))}if(o||r>1)return c;throw f=!0,n}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),i=l,s=m;(t=i<2?e:s)||!f;){a||(i?i<3?(i>1&&(h.n=-1),d(i,s)):h.n=s:h.v=s);try{if(u=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=h.n<0)?s:r.call(n,h))!==c)break}catch(t){a=e,i=1,s=t}finally{u=1}}return{value:t,done:f}}}(r,o,a),!0),u}var c={};function i(){}function s(){}function u(){}t=Object.getPrototypeOf;var l=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,(function(){return this})),t),f=u.prototype=i.prototype=Object.create(l);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=u,_regeneratorDefine2(f,"constructor",u),_regeneratorDefine2(u,"constructor",s),s.displayName="GeneratorFunction",_regeneratorDefine2(u,o,"GeneratorFunction"),_regeneratorDefine2(f),_regeneratorDefine2(f,o,"Generator"),_regeneratorDefine2(f,n,(function(){return this})),_regeneratorDefine2(f,"toString",(function(){return"[object Generator]"})),(_regenerator=function(){return{w:a,m:h}})()}function _regeneratorDefine2(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,t,r,n){if(t)o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{var a=function(t,r){_regeneratorDefine2(e,t,(function(e){return this._invoke(t,r,e)}))};a("next",0),a("throw",1),a("return",2)}},_regeneratorDefine2(e,t,r,n)}function asyncGeneratorStep(e,t,r,n,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function c(e){asyncGeneratorStep(a,n,o,c,i,"next",e)}function i(e){asyncGeneratorStep(a,n,o,c,i,"throw",e)}c(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var FormManagementSystem=function(){return _createClass((function e(){var t,r=this;_classCallCheck(this,e),this.targetWorkbookName="test.xlsx",this.targetSheetName="Sheet1",this.isAddInConfigured=!0,this.initializeExcelEvents(),this.currentMonth=new Date,this.loadFromExcel().then((function(){r.init()})),null===(t=document.getElementById("testExcel"))||void 0===t||t.addEventListener("click",_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getItem("Sheet1").getRange("A1").values=[["TEST_"+(new Date).toLocaleTimeString()]],e.n=1,t.sync();case 1:alert("Écriture réussie ! Vérifiez la cellule A1");case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Erreur Excel :",t),alert("Échec : "+t.message);case 3:return e.a(2)}}),e,null,[[0,2]])})))),this.forms={}}),[{key:"init",value:function(){var e=this;this.updateCurrentDate(),this.updateCurrentMonth(),this.renderForms(),this.updateStats(),this.setupEventListeners(),setInterval((function(){return e.updateCurrentDate()}),6e4)}},{key:"initializeExcelEvents",value:(d=_asyncToGenerator(_regenerator().m((function e(){var t,r=this;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,Office.context.host!==Office.HostType.Excel){e.n=2;break}return e.n=1,this.getSetting("test");case 1:return e.v&&(this.isAddInConfigured=!0,this.monitorSheetActivation()),e.n=2,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.onActivated.add(r.handleSheetActivation.bind(r)),e.n=1,t.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error initializing Excel events:",t);case 4:return e.a(2)}}),e,this,[[0,3]])}))),function(){return d.apply(this,arguments)})},{key:"monitorSheetActivation",value:(h=_asyncToGenerator(_regenerator().m((function e(){var t,r=this;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(t){var n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.worksheets.getActiveWorksheet()).load("test"),e.n=1,t.sync();case 1:n.name===r.targetSheetName&&Office.addin.showAsTaskpane();case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error monitoring sheet activation:",t);case 3:return e.a(2)}}),e,null,[[0,2]])}))),function(){return h.apply(this,arguments)})},{key:"handleSheetActivation",value:(f=_asyncToGenerator(_regenerator().m((function e(t){var r,n;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,(r=t.worksheet).load("name"),e.n=1,t.context.sync();case 1:r.name===this.targetSheetName&&this.isAddInConfigured&&Office.addin.showAsTaskpane(),e.n=3;break;case 2:e.p=2,n=e.v,console.error("Error handling sheet activation:",n);case 3:return e.a(2)}}),e,this,[[0,2]])}))),function(e){return f.apply(this,arguments)})},{key:"configureForTargetSheet",value:(l=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,this.setSetting("targetSheetConfigured",!0);case 1:this.isAddInConfigured=!0,this.monitorSheetActivation(),this.showToast("Add-in will now open automatically for this sheet"),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error configuring for target sheet:",t),this.showToast("Error configuring automatic opening","error");case 3:return e.a(2)}}),e,this,[[0,2]])}))),function(){return l.apply(this,arguments)})},{key:"getSetting",value:(u=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)if(0===e.n)return e.a(2,new Promise((function(e){Office.context.document.settings.get(t,(function(t){t.status===Office.AsyncResultStatus.Succeeded?e(t.value):e(null)}))})))}),e)}))),function(e){return u.apply(this,arguments)})},{key:"setSetting",value:(s=_asyncToGenerator(_regenerator().m((function e(t,r){return _regenerator().w((function(e){for(;;)if(0===e.n)return e.a(2,new Promise((function(e){Office.context.document.settings.set(t,r),Office.context.document.settings.saveAsync((function(t){e(t.status===Office.AsyncResultStatus.Succeeded)}))})))}),e)}))),function(e,t){return s.apply(this,arguments)})},{key:"loadFromExcel",value:(i=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,_loadFromExcel();case 1:this.forms=e.v;case 2:return e.a(2)}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"saveToExcel",value:(c=_asyncToGenerator(_regenerator().m((function e(){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,_saveToExcel(this.forms);case 1:return e.a(2)}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this;document.addEventListener("input",(function(t){t.target.classList.contains("form-textarea")&&e.isCurrentMonth()&&e.autoSave()})),document.addEventListener("keydown",(function(t){if(t.target.classList.contains("form-textarea")&&"Enter"===t.key&&!t.shiftKey&&e.isCurrentMonth()){t.preventDefault();var r=t.target,n=r.selectionStart,o=r.selectionEnd;r.value=r.value.substring(0,n)+"\n"+r.value.substring(o),r.selectionStart=r.selectionEnd=n+1,e.autoSave()}}))}},{key:"updateCurrentDate",value:function(){var e=new Date;document.getElementById("current-date").textContent=e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}},{key:"isCurrentMonth",value:function(){var e=new Date;return this.currentMonth.getMonth()===e.getMonth()&&this.currentMonth.getFullYear()===e.getFullYear()}},{key:"updateCurrentMonth",value:function(){var e="".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][this.currentMonth.getMonth()]," ").concat(this.currentMonth.getFullYear());document.getElementById("current-month").textContent=e,document.getElementById("nav-month").textContent=e}},{key:"formatDate",value:function(e){var t=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),n=e.getFullYear();return"".concat(t,"/").concat(r,"/").concat(n)}},{key:"formatDateTime",value:function(e){var t=this.formatDate(e),r=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return"".concat(t," ").concat(r)}},{key:"loadFromStorage",value:(a=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,_loadFromExcel();case 1:return e.a(2,e.v);case 2:return e.p=2,t=e.v,console.error("Error loading from Excel:",t),e.a(2,{})}}),e,null,[[0,2]])}))),function(){return a.apply(this,arguments)})},{key:"saveToStorage",value:(o=_asyncToGenerator(_regenerator().m((function e(){var t;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,_saveToExcel(this.forms);case 1:this.updateLastUpdated(),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error saving to Excel:",t),this.showToast("Error saving data","error");case 3:return e.a(2)}}),e,this,[[0,2]])}))),function(){return o.apply(this,arguments)})},{key:"autoSave",value:function(){var e=this;clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(_asyncToGenerator(_regenerator().m((function t(){return _regenerator().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,e.saveAllForms();case 1:return t.a(2)}}),t)}))),1e3)}},{key:"saveAllForms",value:(n=_asyncToGenerator(_regenerator().m((function e(){var t=this;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return document.querySelectorAll(".form-textarea").forEach((function(e){var r=e.dataset.formId;r&&t.forms[r]&&(t.forms[r].content=e.value,t.forms[r].lastModified=(new Date).toISOString())})),e.n=1,this.saveToStorage();case 1:return e.a(2)}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"updateLastUpdated",value:function(){var e=(new Date).toLocaleString();document.getElementById("last-updated").textContent=e}},{key:"getMonthKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentMonth;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))}},{key:"getCurrentMonthForms",value:function(){var e=this.getMonthKey();return Object.values(this.forms).filter((function(t){return t.monthKey===e})).sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)}))}},{key:"addNewForm",value:(r=_asyncToGenerator(_regenerator().m((function e(){var t,r,n,o;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return t=new Date,r="form_".concat(t.getTime()),n=this.getMonthKey(),o={id:r,createdAt:t.toISOString(),lastModified:t.toISOString(),monthKey:n,content:"",date:this.formatDate(t)},this.forms[r]=o,e.n=1,this.saveToStorage();case 1:this.renderForms(),this.updateStats();case 2:return e.a(2)}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"deleteForm",value:(t=_asyncToGenerator(_regenerator().m((function e(t){return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(!this.forms[t]){e.n=2;break}return delete this.forms[t],e.n=1,this.saveToExcel();case 1:this.renderForms(),this.updateStats(),this.showToast("Form deleted successfully!");case 2:return e.a(2)}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"duplicateForm",value:(e=_asyncToGenerator(_regenerator().m((function e(t){var r,n,o,a;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:if(!this.forms[t]){e.n=2;break}return r=this.forms[t],n=new Date,o="form_".concat(n.getTime()),a=_objectSpread(_objectSpread({},r),{},{id:o,createdAt:n.toISOString(),lastModified:n.toISOString(),date:this.formatDate(n)}),this.forms[o]=a,e.n=1,this.saveToExcel();case 1:this.renderForms(),this.updateStats(),this.showToast("Form duplicated successfully!");case 2:return e.a(2)}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"changeMonth",value:function(e){this.currentMonth.setMonth(this.currentMonth.getMonth()+e),this.updateCurrentMonth(),this.renderForms()}},{key:"goToToday",value:function(){this.currentMonth=new Date,this.updateCurrentMonth(),this.renderForms()}},{key:"renderForms",value:function(){var e=document.getElementById("forms-container"),t=document.getElementById("empty-state"),r=this.getCurrentMonthForms(),n=this.isCurrentMonth();e.innerHTML="",0===r.length?t.classList.remove("hidden"):(t.classList.add("hidden"),r.forEach((function(t){var r=document.createElement("div");r.className="form-entry",r.innerHTML='\n                    <div class="form-header">\n                        <div class="form-date">Added on: '.concat(t.date,'</div>\n                        <div class="form-actions">\n                            <button ').concat(n?"onclick=\"formSystem.duplicateForm('".concat(t.id,"')\""):"disabled",">Duplicate</button>\n                            <button ").concat(n?"onclick=\"formSystem.deleteForm('".concat(t.id,"')\""):"disabled",'>Delete</button>\n                        </div>\n                    </div>\n                    <div class="form-content">\n                        <textarea class="form-textarea" data-form-id="').concat(t.id,'" ').concat(n?"":"readonly",' placeholder="Enter your comment here...">').concat(t.content,"</textarea>\n                    </div>\n                "),e.appendChild(r)}))),document.querySelector(".btn-primary").disabled=!n}},{key:"updateStats",value:function(){var e=Object.keys(this.forms).length,t=this.getCurrentMonthForms().length;document.getElementById("total-forms").textContent=e,document.getElementById("month-forms").textContent=t}},{key:"showToast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",r=document.getElementById("toast");document.getElementById("toast-message").textContent=e,r.className="toast ".concat(t),r.classList.add("show"),setTimeout((function(){r.classList.remove("show")}),3e3)}},{key:"exportData",value:function(){document.getElementById("export-modal").classList.add("show")}},{key:"closeExportModal",value:function(){document.getElementById("export-modal").classList.remove("show")}},{key:"exportToJSON",value:function(){var e=JSON.stringify(this.forms,null,2),t="data:application/json;charset=utf-8,"+encodeURIComponent(e),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download","payroll-forms.json"),r.click(),this.closeExportModal()}},{key:"exportToCSV",value:function(){var e=this.getCurrentMonthForms(),t="id,createdAt,lastModified,monthKey,content,date\n";e.forEach((function(e){t+='"'.concat(e.id,'","').concat(e.createdAt,'","').concat(e.lastModified,'","').concat(e.monthKey,'","').concat(e.content.replace(/"/g,'""'),'","').concat(e.date,'"\n')}));var r="data:text/csv;charset=utf-8,"+encodeURIComponent(t),n=this.getMonthKey(this.currentMonth),o="payroll-forms-".concat(n,".csv"),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download",o),a.click(),this.closeExportModal()}},{key:"exportToText",value:function(){var e="";Object.values(this.forms).forEach((function(t){e+="ID: ".concat(t.id,"\nCreated At: ").concat(t.createdAt,"\nLast Modified: ").concat(t.lastModified,"\nMonth: ").concat(t.monthKey,"\nDate: ").concat(t.date,"\nContent: ").concat(t.content,"\n\n")}));var t="data:text/plain;charset=utf-8,"+encodeURIComponent(e),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download","payroll-forms.txt"),r.click(),this.closeExportModal()}},{key:"clearAllData",value:function(){confirm("Are you sure you want to clear all data?")&&(this.forms={},this.saveToStorage(),this.renderForms(),this.updateStats(),this.showToast("All data cleared successfully!"))}}]);var e,t,r,n,o,a,c,i,s,u,l,f,h,d}();function _loadFromExcel(){return _loadFromExcel3.apply(this,arguments)}function _loadFromExcel3(){return _loadFromExcel3=_asyncToGenerator(_regenerator().m((function e(){var t,r,n=this;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,t={},e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(r){var o,a,c,i,s,u,l,f;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return o=r.workbook.worksheets.getItem(n.targetSheetName),(a=o.getUsedRange()).load("values, rowCount"),e.n=1,r.sync();case 1:if(a.rowCount>1)for(c=a.values,i=c[0],s=1;s<c.length;s++){for(u=c[s],l={},f=0;f<i.length;f++)l[i[f]]=u[f];t[l.id]=l}case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2,t);case 2:return e.p=2,r=e.v,console.error("Error loading data from Excel:",r),e.a(2,{})}}),e,null,[[0,2]])}))),_loadFromExcel3.apply(this,arguments)}function _saveToExcel(e){return _saveToExcel3.apply(this,arguments)}function _saveToExcel3(){return _saveToExcel3=_asyncToGenerator(_regenerator().m((function e(t){var r,n=this;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=_asyncToGenerator(_regenerator().m((function e(r){var o,a,c,i;return _regenerator().w((function(e){for(;;)switch(e.n){case 0:return(o=r.workbook.worksheets.getItem(n.targetSheetName)).getUsedRange().clear(),c=[a=["id","createdAt","lastModified","monthKey","content","date"]],Object.values(t).forEach((function(e){c.push([e.id,e.createdAt,e.lastModified,e.monthKey,e.content,e.date])})),(i=o.getRangeByIndexes(0,0,c.length,a.length)).values=c,i.getRow(0).format.fill.color="#4472C4",i.getRow(0).format.font.color="white",i.getRow(0).format.font.bold=!0,e.n=1,r.sync();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:throw e.p=2,r=e.v,console.error("Error saving data to Excel:",r),r;case 3:return e.a(2)}}),e,null,[[0,2]])}))),_saveToExcel3.apply(this,arguments)}var formSystem=new FormManagementSystem;function configureAutoOpen(){formSystem.configureForTargetSheet()}